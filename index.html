<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>วินเลขรวม</title>

<link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700;800&display=swap" rel="stylesheet">

<style>
  body{
    font-family:'Sarabun',sans-serif;
    background:#f3e5f5;
    padding:20px;
    text-align:center;
  }
  .box{
    max-width:650px;
    margin:auto;
    background:#fff;
    padding:22px;
    border-radius:18px;
    box-shadow:0 8px 22px rgba(0,0,0,.15);
  }
  h2{ color:#8e24aa; margin:0 0 14px; }

  textarea{
    width:100%;
    height:120px;
    font-size:16px;
    padding:12px;
    border-radius:12px;
    border:1px solid #ddd;
    outline:none;
    resize: vertical;
  }

  .btn-row{
    margin-top:14px;
    display:flex;
    gap:10px;
    justify-content:center;
    flex-wrap:wrap;
  }

  button{
    padding:10px 22px;
    font-size:16px;
    border:none;
    border-radius:12px;
    cursor:pointer;
    color:#fff;
  }
  .btn-run{ background:#8e24aa; }
  .btn-clear{ background:#ff5722; }
  .btn-copy{ background:#2196f3; }

  .result{
    margin-top:18px;
    text-align:left;
    background:#f8eafc;
    padding:16px;
    border-radius:14px;
    white-space:pre-wrap;
    word-break:break-word;
    line-height:1.45;
  }

  .copied-msg{
    display:none;
    margin-top:10px;
    color:green;
    font-weight:800;
  }
</style>
</head>

<body>
<div class="box">
  <h2>วินเลขรวม (หลายชุด)</h2>

  <textarea id="input" placeholder="พิมพ์เลขหลายชุดได้เลย เช่น&#10;1025&#10;1256&#10;8015&#10;8156"></textarea>

  <div class="btn-row">
    <button class="btn-run" onclick="run()">วินเลขรวม</button>
    <button class="btn-clear" onclick="resetAll()">เริ่มใหม่</button>
    <button class="btn-copy" onclick="copyAll()">คัดลอกทั้งหมด</button>
  </div>

  <div id="copied" class="copied-msg">คัดลอกแล้ว!</div>
  <div id="output" class="result"></div>
</div>

<script>
  function toThaiNumber(n){
    const th = ['๐','๑','๒','๓','๔','๕','๖','๗','๘','๙'];
    return n.toString().split('').map(d => th[+d] ?? d).join('');
  }

  function hasDuplicates(str){
    return /(.).*\1/.test(str);
  }

  // ตัดตัวหนังสือ/สัญลักษณ์: เก็บแค่เลข แล้วใช้เป็นตัวคั่นชุด
  function normalizeToLines(raw){
    // แทนทุกอย่างที่ไม่ใช่เลขด้วย \n แล้วค่อยแยกบรรทัด
    const cleaned = raw.replace(/[^\d]+/g, '\n').trim();
    if(!cleaned) return [];
    return cleaned.split(/\n+/).map(s => s.trim()).filter(Boolean);
  }

  function buildPairs(num){
    // จับคู่เลข 2 ตัวแบบ "เรียงตามลำดับอินพุต" (i < j) และไม่เอาซ้ำ
    const set = new Set();
    for(let i=0;i<num.length;i++){
      for(let j=i+1;j<num.length;j++){
        set.add(num[i] + num[j]);
      }
    }
    return Array.from(set);
  }

  function run(){
    const raw = document.getElementById("input").value;
    const lines = normalizeToLines(raw);

    if(lines.length === 0){
      document.getElementById("output").textContent = "กรุณาพิมพ์เลขอย่างน้อย 2 ตัวต่อชุด";
      document.getElementById("copied").style.display = "none";
      return;
    }

    // เช็คเลขซ้ำแบบเดียวกับอันเก่า: ถ้าพบ ให้เด้งเตือนแล้ว “หยุดทันที”
    for(let i=0;i<lines.length;i++){
      const num = lines[i];
      if(num.length < 2) continue;
      if(hasDuplicates(num)){
        alert("❗️เลขซ้ำ เเจ้งลค.= เลขซ้ำจ้า แอดขอเลขใหม่จ้าพี่\n(พบในชุดที่ " + toThaiNumber(i+1) + " : " + num + ")");
        return;
      }
    }

    let out = "";
    let any = false;

    lines.forEach((num, idx) => {
      if(num.length < 2) return;

      any = true;
      const pairs = buildPairs(num);

      out += `ชุดที่${toThaiNumber(idx+1)}\n`;
      out += pairs.join(" ") + "\n\n";
    });

    document.getElementById("output").textContent = any ? out.trim() : "กรุณาพิมพ์เลขอย่างน้อย 2 ตัวต่อชุด";
    document.getElementById("copied").style.display = "none";
  }

  function resetAll(){
    document.getElementById("input").value = "";
    document.getElementById("output").textContent = "";
    document.getElementById("copied").style.display = "none";
    setTimeout(() => focusInput(), 0);
  }

  function copyAll(){
    const text = document.getElementById("output").textContent.trim();
    if(!text) return;

    navigator.clipboard.writeText(text).then(() => {
      const msg = document.getElementById("copied");
      msg.style.display = "block";
      setTimeout(() => msg.style.display = "none", 1500);
    });
  }

  // Enter = วินเลขรวม (Shift+Enter ยังขึ้นบรรทัดใหม่ได้)
  document.getElementById("input").addEventListener("keydown", function(e){
    if(e.key === "Enter" && !e.shiftKey){
      e.preventDefault();
      run();
    }
  });

  // โฟกัสอัตโนมัติ
  function focusInput(){
    const el = document.getElementById("input");
    if(!el) return;
    el.focus({preventScroll:true});
  }
  window.addEventListener("load", focusInput);
  window.addEventListener("pageshow", focusInput);
</script>
</body>
</html>
